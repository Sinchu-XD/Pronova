[phases.setup]
aptPkgs = [
  "git",
  "curl",
  "python3",
  "python3-pip",
  "ffmpeg",
  "build-essential"
]

[phases.install]
cmds = [
  # Install Node 20
  "curl -fsSL https://deb.nodesource.com/setup_20.x | bash -",
  "apt-get install -y nodejs",

  # Install pipx
  "python3 -m pip install --upgrade pip",
  "pip install --break-system-packages pipx",
  "pipx ensurepath",

  # Install bot requirements
  "pip install --break-system-packages -r requirements.txt",

  # Remove pip yt-dlp if exists
  "pip uninstall -y yt-dlp || true",

  # Install yt-dlp via pipx
  "pipx install yt-dlp[default] || true"
]

[phases.start]
cmd = "python3 -m Bot"
